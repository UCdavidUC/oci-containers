<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.10">
<meta name="description" content="A chapter OCI containers.">
<meta name="author" content="David Sanchez">
<title>Creating and Running OCI Containers</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/* Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment @import statement to use as custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section{display:block}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*::before,*::after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto;tab-size:4;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite::before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed;word-wrap:break-word}
:not(pre)>code.nobreak{word-wrap:normal}
:not(pre)>code.nowrap{white-space:nowrap}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details>summary:first-of-type{cursor:pointer;display:list-item;outline:none;margin-bottom:.75em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class="highlight"],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos{border-right:1px solid currentColor;opacity:.35;padding-right:.5em}
pre.pygments .lineno{border-right:1px solid currentColor;opacity:.35;display:inline-block;margin-right:.75em}
pre.pygments .lineno::before{content:"";margin-right:-.125em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;text-align:left;margin-right:0}
table.tableblock{max-width:100%;border-collapse:separate}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
td.tableblock>.content>:last-child.sidebarblock{margin-bottom:0}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>thead>tr>.tableblock,table.grid-all>tbody>tr>.tableblock{border-width:0 1px 1px 0}
table.grid-all>tfoot>tr>.tableblock{border-width:1px 1px 0 0}
table.grid-cols>*>tr>.tableblock{border-width:0 1px 0 0}
table.grid-rows>thead>tr>.tableblock,table.grid-rows>tbody>tr>.tableblock{border-width:0 0 1px}
table.grid-rows>tfoot>tr>.tableblock{border-width:1px 0 0}
table.grid-all>*>tr>.tableblock:last-child,table.grid-cols>*>tr>.tableblock:last-child{border-right-width:0}
table.grid-all>tbody>tr:last-child>.tableblock,table.grid-all>thead:last-child>tr>.tableblock,table.grid-rows>tbody>tr:last-child>.tableblock,table.grid-rows>thead:last-child>tr>.tableblock{border-bottom-width:0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot,table.frame-ends{border-width:1px 0}
table.stripes-all tr,table.stripes-odd tr:nth-of-type(odd),table.stripes-even tr:nth-of-type(even),table.stripes-hover tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{margin-right:.25em}
ul.inline{display:-ms-flexbox;display:-webkit-box;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media print,amzn-kf8{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
</head>
<body class="article">
<div id="header">
<h1>Creating and Running OCI Containers</h1>
<div class="details">
<span id="author" class="author">David Sanchez</span><br>
<span id="email" class="email"><a href="mailto:divad_dad@hotmail.com">divad_dad@hotmail.com</a></span><br>
<span id="revnumber">version 1.0,</span>
<span id="revdate">01.07.2020</span>
<br><span id="revremark">First review</span>
</div>
<div id="toc" class="toc">
<div id="toctitle">Contents</div>
<ul class="sectlevel1">
<li><a href="#_the_open_container_initiative">The Open Container Initiative</a>
<ul class="sectlevel2">
<li><a href="#_introduction">Introduction</a></li>
<li><a href="#_runtime_specification">Runtime Specification</a></li>
<li><a href="#_image_format_specification">Image Format Specification</a></li>
</ul>
</li>
<li><a href="#_tools">Tools</a>
<ul class="sectlevel2">
<li><a href="#_buildah">Buildah</a></li>
<li><a href="#_podman">Podman</a></li>
</ul>
</li>
<li><a href="#_comparison_between_buildah_and_dockerfile">Comparison between Buildah and Dockerfile</a>
<ul class="sectlevel2">
<li><a href="#_container_build">Container build</a></li>
</ul>
</li>
<li><a href="#_references">References</a></li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="quoteblock abstract">
<blockquote>
The objective of this chapter is that the student understands the basic concepts of the Open Container Initiative (OCI), Buildah, Podman and RunC. This concepts will set the basis on how containers are created, deployed and run using this tools.
</blockquote>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_the_open_container_initiative">The Open Container Initiative</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_introduction">Introduction</h3>
<div class="paragraph">
<p>The Open Container Initiative or OCI defines an open source initiative for container runtime and image specifications. The initiative dates back to 2015, it was established by Docker and other leaders in the containers industry, nowadays it is supported by the Linux Foundation.</p>
</div>
<div class="paragraph">
<p>This initiative is relevant for the reason that it was first stablished to set a base for container standards definition. As other industry standards such as HTTP it is build on top of open source.</p>
</div>
<div class="paragraph">
<p>The initiative is made up to two main elements:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The Runtime Specification</p>
</li>
<li>
<p>The Image Specification</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The general structure of a workflow is as follows:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/workflow.png" alt="workflow" width="700" height="336">
</div>
</div>
<div class="paragraph">
<p>In this diagram the build system is responsible of using the information from the OCI image format on how to create the OCI image, the build system will return the following elements and subelements:</p>
</div>
<div class="paragraph">
<p>OCI Image:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Image configuration</p>
<div class="ulist">
<ul>
<li>
<p>Application arguments</p>
</li>
<li>
<p>Environments</p>
</li>
</ul>
</div>
</li>
<li>
<p>Image manifest</p>
<div class="ulist">
<ul>
<li>
<p>Metadata from:</p>
<div class="ulist">
<ul>
<li>
<p>Dependencies</p>
</li>
<li>
<p>Contents</p>
</li>
</ul>
</div>
</li>
<li>
<p>Filesystem serialization archive&#8217;s addressable identity.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Filesystem serialization</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This workflow contains all the required information for the user to run a command without arguments in the CLI just as running a Docker or CoreOS command.</p>
</div>
<div class="paragraph">
<p>In the following sections the specifications require for both the runtime and the image will be detailed so that at the end of this chapter the student knows the basic information to specify an OCI container image and runtime.</p>
</div>
</div>
<div class="sect2">
<h3 id="_runtime_specification">Runtime Specification</h3>
<div class="paragraph">
<p>The Runtime Specification or runtime-spec contains the definition on how to run a filesystem.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
The filesystem is in a bundle which means that it needs to be unpacked.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The components of the runtime-spec are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Execution environment</p>
</li>
<li>
<p>Lifecycle of a container</p>
</li>
<li>
<p>Configruration</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The name of the file that specifies this elements is the config.json.</p>
</div>
</div>
<div class="sect2">
<h3 id="_image_format_specification">Image Format Specification</h3>
<div class="paragraph">
<p>This is the description on how to create the necessary set of tools for container image build, transport and preparation so it can run under the runtime specification.</p>
</div>
<div class="paragraph">
<p>The image format specification or image-spec is made up of the elements in the following table:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Element</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Manifest</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Contains each one of the elements that the image-spec is made of. (i.e. The elements in this list).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Configuration</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Contains the definition of the image and the description of the order in the layers.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Filesystem Layer(s)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Is the description of the filesystem of the container including the changes of the filesystem.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Image index</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Is the list on the image manifest(s).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Layout</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Is the description of the layout of the elements of the container image.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Filesystem Layer(s)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Is the description of the filesystem of the container including the changes of the filesystem.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Descriptor</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">As it name says, it is the element that describes the information such as type, the metadata related to it and the address of the references.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Conversor</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Describes the processes of translation.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_tools">Tools</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_buildah">Buildah</h3>
<div class="paragraph">
<p>This chapter&#8217;s sections is an overview of the Buildah tool.</p>
</div>
<div class="paragraph">
<p>Buildah is an open source tool created for building OCI container images. This means that the tool uses the image-spec definition from and OCI image.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Buildah supports Docker based image build. This characteristic makes it posible to run in a Docker environment a Buildah built OCI container image. This compatibility turns OCI and it&#8217;s set of tools into a very powerful way of defining container images and it also comes with a lot of flexibility.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_podman">Podman</h3>
<div class="paragraph">
<p>This chapter&#8217;s sections is an overview of the Podman tool.</p>
</div>
<div class="paragraph">
<p>Podman is another great tool in the OCI environments. It can be used through the CLI to manage the building, distribution, sharing, depliyment and running applications based on OCI containers.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
A great advantage of Podman is that it uses similar commands, command&#8217;s arguments and options as Docker, which means that podman and docker commands are replaceble when managing container images.
</td>
</tr>
</table>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
Podman is made for Linux so it only runs on Linux! Windows or Mac users can take advantage of the RESTful remote client to explode Podman&#8217;s capabilities.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Podman controls the OCI container environment including:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Pods</p>
</li>
<li>
<p>Container images</p>
</li>
<li>
<p>Containers</p>
</li>
<li>
<p>Volumes</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_comparison_between_buildah_and_dockerfile">Comparison between Buildah and Dockerfile</h2>
<div class="sectionbody">
<div class="paragraph">
<p>As we can deduce Docker, Buildah and Podman have all the same or pretty similar functionality and characteristics, let&#8217;s checkout what are the differences between Buildah and Docker to get a general overview of both of them.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Feature</th>
<th class="tableblock halign-left valign-top">Buildah</th>
<th class="tableblock halign-left valign-top">Docker</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Compatibility</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Builds and runs OCI and Docker compliant container images.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Only runs Docker compliant images.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Container runtime daemon</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Not needed.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Needed.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Root user</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Not needed.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Needed.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Dockerfile cache</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Not supported.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Supported.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Script the container in Bash</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Supported.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Not supported.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OpenShift Source-to-Image (S2I)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Supported.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Not supported.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>As part of this comparison there is algo a difference between Buildah and Podman and it is that Podman implemets contenerization the same way as Docker in the good all fashion for applications that will be maintained and managed in a mid to long time period, while Buildah will let the user build easily and also fast OCI container images. This explain why the comparison is limited to Docker and Buildah.</p>
</div>
<div class="sect2">
<h3 id="_container_build">Container build</h3>
<div class="paragraph">
<p>Enough theory, let&#8217;s go to action&#8230;&#8203;</p>
</div>
<div class="paragraph">
<p>This sections decribes how to build and run containers in both Docker and Buildah, it also considers that the build and run will be done in a Linux environment. The following guidelines were executed on a Ubuntu 18.04 LTS (Bionic Beaver) version.</p>
</div>
<div class="sect3">
<h4 id="_with_docker">With Docker</h4>
<div class="paragraph">
<p>To use Docker the first thing to to is to setup the Docker environment as described in the official documentation in the <a href="https://docs.docker.com/get-started/">link</a> <a href="#dgs">[1]</a>.</p>
</div>
<div class="paragraph">
<p>As prerrequisites for using Docker follow the steps, otherwise jump directly to the Docker CLI installation.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>docker --version <i class="conum" data-value="1"></i><b>(1)</b>

sudo apt-get remove docker docker-engine docker.io containerd runc <i class="conum" data-value="2"></i><b>(2)</b>

sudo apt-get install \
software-properties-common \
apt-transport-https \
ca-certificates \
gnupg-agent <i class="conum" data-value="3"></i><b>(3)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Validate that Docker exists in the computer by running:</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>If you are not sure or if the version installed in the computer is old run the following command to uninstall previous versions of Docker.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Install base communication and security packages required by the Docker engine.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>As previously stablished Docker requires a daemon to be running in the machine, the Docker daemon is the dockerd or Docker Engine, this daemon needs to be running for the docker commands to execute from the CLI.</p>
</div>
<div class="paragraph">
<p>There are two ways of install Docker one is by using a DEB package and running it or by configuring the Docker repository and installing from the command line which is described here, here it is described how to do it using the CLI and the official Docker repository:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>sudo apt-get update <i class="conum" data-value="1"></i><b>(1)</b>

sudo apt-get install curl <i class="conum" data-value="2"></i><b>(2)</b>

curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo apt-key add - <i class="conum" data-value="3"></i><b>(3)</b>

sudo add-apt-repository \
"deb [OPTION] https://download.docker.com/linux/ubuntu $(lsb_release -cs) stable" <i class="conum" data-value="4"></i><b>(4)</b>

sudo apt-get update <i class="conum" data-value="5"></i><b>(5)</b>

sudo apt-get install docker-ce docker-ce-cli containerd.io <i class="conum" data-value="6"></i><b>(6)</b>

sudo docker run hello-world <i class="conum" data-value="7"></i><b>(7)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Through official Docker repository, start by running an update.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>To get the repository key in this settings it is used the curl command, if you do not have it installed in your computer run the command below, otherwise jump this step.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Add the GPG from Docker.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Once the key is intalled, the next step is to set the Docker repository, there are three different supported CPU architectures supported by the Docker engine. It is important to replace the word [OPTION] inside the brackets in the command for one of the following options: <code>arch=amd64</code>, <code>arch=armhf</code> or <code>arch=arm64</code> that corresponds to the computer.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Run the update command.</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>Install Docker engine.</td>
</tr>
<tr>
<td><i class="conum" data-value="7"></i><b>7</b></td>
<td>Run this command to verify that Docker has installed correctly.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>For building and running container images in Docker there are two commands <code>docker build</code> and <code>docker run</code> respectively.</p>
</div>
<div class="paragraph">
<p>When Docker builds a container image it takes the Dockerfile and a set of other files also known as context. The Docker build command can use the context files as a reference. The Dockerfile specifies the assembly of the filesystem for the container image and optional metadata describing the way it must be run.</p>
</div>
<div class="paragraph">
<p>When <code>docker build</code> is executed a new container is created to process the Dockerfile, this creates new metadata.</p>
</div>
<div class="paragraph">
<p>The fastest way to go on on building and running a Docker container is to use a <em>Hello World!</em> approach. To do this follow the steps bellow:</p>
</div>
<div class="paragraph">
<p>First, validate that Docker daemon is running and it is working. You should see a message like the in the image.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>sudo docker run hello-world</pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/docker_hello_world.png" alt="Docker Hello World">
</div>
</div>
<div class="paragraph">
<p>Then, the docker build and docker run commands will be used to run a sample application that can be used in a web browser.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>git clone https://github.com/dockersamples/linux_tweet_app.git <i class="conum" data-value="1"></i><b>(1)</b>

cd linux_tweet_app/ <i class="conum" data-value="2"></i><b>(2)</b>

sudo docker build -t linux_tweet_app . <i class="conum" data-value="3"></i><b>(3)</b>

sudo docker container run --detach -p 80:80 linux_tweet_app <i class="conum" data-value="4"></i><b>(4)</b></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>For this sample the easiest way to get started is with an application and it&#8217;s Dockerfile. This is not a Hands on Lab, this is to demostrate how Docker container application is built and run, so what is needed to do is to have an application in the fist place. A sample application available in the Docker Samples GitHub site <a href="#di">[2]</a> is used as a container application. First, clone the application from the Git repository, make sure to do this in a new directory.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Access to the cloned project folder. You will see the application files and the Dockerfile.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Build the image from the sample. This command has an option named tag, this option is used to give name to the container image but also define the version, the version goes after the ':'.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Run the image. This command uses the option "--detach" that indicates that de container exits at the same time that the process used to run the container exists as described in the docker run command documentation <a href="#rundocs">[3]</a>. This command also has the "-p" option indicating that the port 80 is open for the linux_tweet_app container.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Go to <a href="http://localhost:80" class="bare">http://localhost:80</a> to view the running application.</p>
</div>
</div>
<div class="sect3">
<h4 id="_with_buildah">With Buildah</h4>
<div class="paragraph">
<p>There is a difference is that it is not a daemon as Docker or Podman and when building Buildah the user has the opportunity to create an empty image and start from zero instead of creating an image based on another container, this also means reduced image size, increased security because it does not packages default libraries, as described in the Red Hat Documentation for Buidah.<a href="#rhdocs">[4]</a></p>
</div>
<div class="paragraph">
<p>Buildah installation varies between Linux distributions which can be found in in the Buildah installation reference <a href="#bir">[5]</a>.</p>
</div>
<div class="paragraph">
<p>For this chapter the installation instructions will focus on Ubuntu 18.04.</p>
</div>
<div class="paragraph">
<p>The following commands will guide you through the process of installation of buildah.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>. /etc/os-release <i class="conum" data-value="1"></i><b>(1)</b>

sudo sh -c "echo 'deb http://download.opensuse.org/repositories/devel:/kubic:/libcontainers:/stable/x${ID^}_${VERSION_ID}/ /' &gt; /etc/apt/sources.list.d/devel:kubic:libcontainers:stable.list" <i class="conum" data-value="2"></i><b>(2)</b>

wget -nv https://download.opensuse.org/repositories/devel:kubic:libcontainers:stable/x${ID^}_${VERSION_ID}/Release.key -O Release.key <i class="conum" data-value="3"></i><b>(3)</b>

sudo apt-key add - &lt; Release.key <i class="conum" data-value="4"></i><b>(4)</b>

sudo apt-get update -qq <i class="conum" data-value="5"></i><b>(5)</b>

sudo apt-get -qq -y install buildah <i class="conum" data-value="6"></i><b>(6)</b></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Get the release of the Operating System that will be used in the following commands.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Get the latest release of buildah.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Get the key for the repository.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Add the key.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Update.</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>Install buildah.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Once buildah is install the next steps are going to be on how to build and run the linux_tweet_app.</p>
</div>
<div class="paragraph">
<p>What is needed to do now is the check if the container from the Docker run revious steps is running, to stop a container run the following Docker commands:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>sudo docker ps <i class="conum" data-value="1"></i><b>(1)</b>

sudo docker container stop &lt;CONTAINER_NAME&gt; <i class="conum" data-value="2"></i><b>(2)</b></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Identify the name of your container.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Stop that container.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Then, navigate to the directory where the application is located and run the following commands to build and run the application image.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>buildah build-using-dockerfile -t linux_tweet . <i class="conum" data-value="1"></i><b>(1)</b>

sudo buildah push linux_tweet:latest docker-daemon:linux_tweet:latest <i class="conum" data-value="2"></i><b>(2)</b>

sudo docker run --detach -p 80:80 linux_tweet <i class="conum" data-value="3"></i><b>(3)</b></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>If you run buildah the first thing to notice is that there is no "build" command, instead there is the build-using-dockerfile which is the same than using the bud command. The second thing that you may notice is that the privileged used permission is not required as it is in Docker.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Podman or Docker can be used to run de image. To run the image just created using buildah the image needs to be copied to the Docker daemon.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Run the buildah image using a Docker container.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Go to <a href="http://localhost:80" class="bare">http://localhost:80</a> to view the running application.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
RunC is the container format and runtime provided by Docker as the base for the OCI. And it is also used by buildah when the buildah run command is used.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This is the end of this chapter, hope you enjoyed it. This may have helped you understand a little about OCI containers, container images and tools for images building and running.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_references">References</h2>
<div class="sectionbody">
<div class="ulist bibliography">
<ul class="bibliography">
<li>
<p><a id="dgs"></a>[1] Getting Started. Official Docker documentation. 2020. Available at: <a href="https://docs.docker.com/" class="bare">https://docs.docker.com/</a></p>
</li>
<li>
<p><a id="di"></a>[2] dockersamples. Docker 101 Tutorial. 2020. Available at: <a href="https://github.com/dockersamples/linux_tweet_app" class="bare">https://github.com/dockersamples/linux_tweet_app</a></p>
</li>
<li>
<p><a id="rundocs"></a>[3] Docker run reference. Docker Docs. 2020. Available at: <a href="https://docs.docker.com/engine/reference/run/#detached-vs-foreground" class="bare">https://docs.docker.com/engine/reference/run/#detached-vs-foreground</a></p>
</li>
<li>
<p><a id="rhdocs"></a>[4] Chapter 6. Building container images with Buildah. Red Hat Customer Portal. 2020. Available at: <a href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/building_running_and_managing_containers/building-container-images-with-buildah_building-running-and-managing-containers" class="bare">https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/building_running_and_managing_containers/building-container-images-with-buildah_building-running-and-managing-containers</a></p>
</li>
<li>
<p><a id="bir"></a>[5] Installation Instructions. buildah. GitHub. 2020. Available at: <a href="https://github.com/containers/buildah/blob/master/install.md" class="bare">https://github.com/containers/buildah/blob/master/install.md</a></p>
</li>
<li>
<p>About the Open Container Initiative. From the Linux Foundation. 2020. Available at: <a href="https://opencontainers.org/about/overview/" class="bare">https://opencontainers.org/about/overview/</a></p>
</li>
<li>
<p>Stephen Walli. Demystifying the Open Container Initiative (OCI) Specifications. docker blog. 2017. Available at: <a href="https://www.docker.com/blog/demystifying-open-container-initiative-oci-specifications/" class="bare">https://www.docker.com/blog/demystifying-open-container-initiative-oci-specifications/</a></p>
</li>
<li>
<p>opencontainers.org. OCI Image Format. 2020. Available at: <a href="https://github.com/opencontainers/image-spec" class="bare">https://github.com/opencontainers/image-spec</a></p>
</li>
<li>
<p>opencontainers.org. OCI Runtime Specification. 2020. Available at: <a href="https://github.com/opencontainers/runtime-spec" class="bare">https://github.com/opencontainers/runtime-spec</a></p>
</li>
<li>
<p>Buildah Docs Tutorial. 2020. Available at: <a href="https://github.com/containers/buildah/tree/master/docs/tutorials" class="bare">https://github.com/containers/buildah/tree/master/docs/tutorials</a></p>
</li>
<li>
<p>Podman Documentation. 2020. Available at: <a href="https://podman.readthedocs.io/en/latest/index.html" class="bare">https://podman.readthedocs.io/en/latest/index.html</a></p>
</li>
<li>
<p>Akihiro Suda. Comparing Next-Generation Container Image Building Tools. NTT. 2018. Available at: <a href="https://events19.linuxfoundation.org/wp-content/uploads/2017/11/Comparing-Next-Generation-Container-Image-Building-Tools-OSS-Akihiro-Suda.pdf" class="bare">https://events19.linuxfoundation.org/wp-content/uploads/2017/11/Comparing-Next-Generation-Container-Image-Building-Tools-OSS-Akihiro-Suda.pdf</a></p>
</li>
<li>
<p>Daniel J. Wash. How rootless Buildah works: Building containers in unprivileged environments. opensource.com. 2019. Available at: <a href="https://opensource.com/article/19/3/tips-tricks-rootless-buildah" class="bare">https://opensource.com/article/19/3/tips-tricks-rootless-buildah</a></p>
</li>
<li>
<p>Docker Docs. 2020. Available at: <a href="https://docs.docker.com/get-started/" class="bare">https://docs.docker.com/get-started/</a></p>
</li>
<li>
<p>Docker Tutorial for Beginners. Guru99. 2020. Available at: <a href="https://www.guru99.com/docker-tutorial.html" class="bare">https://www.guru99.com/docker-tutorial.html</a></p>
</li>
<li>
<p>Develop with Docker. Docker docs. 2020. Available at: <a href="https://docs.docker.com/develop/" class="bare">https://docs.docker.com/develop/</a></p>
</li>
<li>
<p>Install Docker on Ubuntu. Docker Docs. 2020. Available at: <a href="https://docs.docker.com/engine/install/ubuntu/#install-from-a-package" class="bare">https://docs.docker.com/engine/install/ubuntu/#install-from-a-package</a></p>
</li>
<li>
<p>Orientation and setup. Docker Docs. 2020. Available at: <a href="https://docs.docker.com/get-started/" class="bare">https://docs.docker.com/get-started/</a></p>
</li>
<li>
<p>Build and run your image. Docker Docs. 2020. Available at: <a href="https://docs.docker.com/get-started/" class="bare">https://docs.docker.com/get-started/</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Version 1.0<br>
Last updated 2020-07-07 00:20:35 -0500
</div>
</div>
</body>
</html>